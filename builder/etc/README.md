3.2 BUILDER（生成器）—对象创建型模式

1. 意图
将一个复杂对象(构建器的参数列表很长的时候)的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。
重叠构造器也是一个使用比较多的方法，但是需要列出很多的构造器。

2. 动机
一个RTF（Rich Text Format）文档交换格式的阅读器应能将 RT F转换为多种正文格式。 该阅读器可以将RTF文档转换成普通
A S C I I文本或转换成一个能以交互方式编辑的正文窗口组 件。 但问题在于可能转换的数目是无限的。 因此要能够很容易实现
新的转换的增加， 同时却 不改变RTF阅读器。
一个解决办法是用一个可以将 RTF转换成另一种正文表示的TextConverter对象配置这个 RT F R e a d e r类。
当RT F R e a d e r对RTF文档进行语法分析时，它使用 Te x t C o n v e r t e r去做转换。无 论何时RT F R e a d e r识别了一个 RT F标记
（或是普通正文或是一个 RT F控制字）， 它都发送一个 请求给Te x t C o n v e r t e r去转换这个标记。 Te x t C o n v e r t e r对象负责
进行数据转换以及用特定格式 表示该标记，如下图所示。

3. 适用性 在以下情况使用Builder模式
• 当创建复杂对象的算法应该独立于该对象的组成部分以及它们的装配方式时。
• 当构造过程必须允许被构造的对象有不同的表示时。
• 使用构造器创建对象时发现参数列表很长时，难以对应。

5. 参与者
• Builder（TextConverter）
 — 为创建一个Product对象的各个部件指定抽象接口。
• ConcreteBuilder（ASCIIConverter、TeXConverter、TextWidgetConverter）
 — 实现Builder的接口以构造和装配该产品的各个部件。
 — 定义并明确它所创建的表示。
 — 提供一个检索产品的接口（例如， GetASCIIText和GetTextWidget）。
• Director（RTFReader）
 — 构造一个使用Builder接口的对象。
• Product（ASCIIText、TeXText、TextWidget）
 — 表示被构造的复杂对象。 ConcreteBuilder创建该产品的内部表示并定义它的装配过程。
 — 包含定义组成部件的类，包括将这些部件装配成最终产品的接口。


6. 协作
• 客户创建Director对象，并用它所想要的Builder对象进行配置。
• 一旦产品部件被生成，导向器就会通知生成器。
• 生成器处理导向器的请求，并将部件添加到该产品中。
• 客户从生成器中检索产品。 下面的交互图说明了Builder和Director是如何与一个客户协作的。

7. 效果 这里是Builder模式的主要效果：

 1 ) 它使你可以改变一个产品的内部表示 B u i l d e r对象提供给导向器一个构造产品的抽象 接口。
 该接口使得生成器可以隐藏这个产品的表示和内部结构。 它同时也隐藏了该产品是如 何装配的。
 因为产品是通过抽象接口构造的， 你在改变该产品的内部表示时所要做的只是定 义一个新的生成器。
 2) 它将构造代码和表示代码分开 B u i l d e r模式通过封装一个复杂对象的创建和表示方式 提高了对象的模块性。
 客户不需要知道定义产品内部结构的类的所有信息；这些类是不出现 在B u i l d e r接口中的。
 每个 C o n c r e t e B u i l d e r包含了创建和装配一个特定产品的所有代码。
 这些 代码只需要写一次；然后不同的 D i r e c t o r可以复用它以在相同部件集合的基础上构作不同的 P r o d u c t。
 在前面的 RT F例子中，我们可以为 RT F格式以外的格式定义一个阅读器，比如一个 S G M L R e a d e r，
 并使用相同的 Te x t C o n v e r t e r生成 S G M L文档的 A S C I I Te x t、Te X Te x t和 TextWidget译本。
 3 ) 它使你可对构造过程进行更精细的控制 B u i l d e r模式与一下子就生成产品的创建型模 式不同，
 它是在导向者的控制下一步一步构造产品的。 仅当该产品完成时导向者才从生成器 中取回它。因此 B u i l d e r接口相比
 其他创建型模式能更好的反映产品的构造过程。 这使你可以 更精细的控制构建过程，从而能更精细的控制所得产品的内部结构。